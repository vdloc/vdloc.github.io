---
import { readAll } from '../lib/markdoc/read';
import { blog } from '../lib/markdoc/frontmatter.schema';
import PageLayout from '../layouts/PageLayout.astro';
import PageMeta from '../components/common/PageMeta.astro';
import { SITE_TITLE } from '../config';
import { sortPostsByDate } from 'src/utils';
import type { BlogPost } from 'src/types/global';
import BlogListItem from '@components/pages/blog/BlogListItem.astro';

const posts = await readAll({
  directory: 'blog',
  frontmatterSchema: blog,
});

const sortedPosts = sortPostsByDate<BlogPost>(posts);
---

<PageLayout>
  <PageMeta title={`Blog | ${SITE_TITLE}`} slot='meta' />
  <section slot='main'>
    <ul>
      {
        sortedPosts.map((post) => {
          return <BlogListItem post={post} />;
        })
      }
    </ul>
  </section>
</PageLayout>

