---
import { readAll } from '../lib/markdoc/read';
import { project } from '../lib/markdoc/frontmatter.schema';
import PageLayout from '../layouts/PageLayout.astro';
import PageMeta from '@components/common/PageMeta.astro';
import { SITE_TITLE } from '../config';
import { sortPostsByDate } from 'src/utils';
import ProjectListItem from '@components/pages/project/ProjectListItem.astro';
import type { ProjectPost } from 'src/types/global';

const projects = await readAll({
  directory: 'projects',
  frontmatterSchema: project,
});

const sortedProjects = sortPostsByDate<ProjectPost>(projects);
---

<PageLayout>
  <PageMeta title={`Projects | ${SITE_TITLE}`} slot='meta' />
  <section slot='main'>
    <ul>
      {
        sortedProjects.map((project) => {
          return <ProjectListItem post={project} />;
        })
      }
    </ul>
  </section>
</PageLayout>
